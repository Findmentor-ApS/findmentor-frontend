<app-secondary-navigation></app-secondary-navigation>
<div class="overviewWrap">
  <div class="container">
      <div class="row">
    <!-- Contacts Section -->
        <div class="col-md-3 contact">
          <h3>Beskeder</h3>
          <div class="list-group">
            <ul class="contacts">
              <li *ngFor="let contact of contacts" (click)="loadMessagesForContact(contact)" [ngClass]="{ 'active': contact === selectedContact }">
                <h4><b>{{ contact.first_name }} {{ contact.last_name }}</b></h4>
                <h6 class="snippet">{{ contact.last_message_content }} </h6>
                <h6 class="snippetDate">{{ contact.last_message_at | date: 'dd. MMMM yyyy - HH:mm' }}</h6>
              </li>
            </ul>
          </div>
        </div>

        <!-- Messages Section -->
        <div class="col-md-9 chat" *ngIf="!selectedContact">
          <h3>VÃ¦lg en kontakt</h3>
        </div>
        <div class="col-md-9 chat" *ngIf="selectedContact">
          <div class="name">
            <h3 *ngIf="selectedContact"> {{ selectedContact.first_name }} {{ selectedContact.last_name }}</h3>
          </div>
          <div *ngIf="selectedContact" class="messages-container mb-3" infiniteScroll
          [infiniteScrollUpDistance]="1"
          [infiniteScrollThrottle]="300"
          [scrollWindow]="false"
          (scrolledUp)="onScroll()">
            <div *ngIf="loading">
              <div class="spinner-container">
                <div class="spinner"></div>
                <div class="spinner-status" role="status">Arbejder</div>
              </div>
            </div>
            <div *ngFor="let message of messages" [ngClass]="{ 'message': true, 'sent-message': message.sender_id === user.id, 'received-message': message.sender_id !== user.id }">
              <div *ngIf="message.sender_id === user.id" class="sent-message">
                <p class="message-content">{{ message.content }}</p>
                <span class="message-timestamp">{{ message.created_at | date: 'dd. MMMM yyyy - HH:mm' }}</span>

              </div>
              <div *ngIf="message.sender_id !== user.id" class="received-message">
                <p class="message-content">{{ message.content }}</p>
                <span class="message-timestamp">{{ message.created_at | date: 'dd. MMMM yyyy - HH:mm' }}</span>

              </div>
              </div>
          </div>

          <!-- Message Input -->
          <div *ngIf="selectedContact" class="input-group">
            <input type="text" class="form-control" [(ngModel)]="messageText" placeholder="Type a message...">
            <button class="btn btn-primary" type="button" (click)="sendMessage()">Send</button>
          </div>
        </div>
      </div>
  </div>
</div>
